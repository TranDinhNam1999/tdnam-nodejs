"use strict";var _require=require("express"),Router=_require.Router,asyncHandler=require("express-async-handler"),User=require("../services/users"),passport=require("../middlewares/passport"),router=new Router;router.get("/",function(e,r){r.render("login")}),router.post("/",passport.authenticate("local",{successRedirect:"/",failureRedirect:"/login",failureFlash:!0})),router.get("/:id/:tooken",asyncHandler(function(r,s){var t,n,o,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.params,n=t.id,o=t.tooken,e.next=3,regeneratorRuntime.awrap(User.findUserById(n));case 3:(a=e.sent)&&a.tooken===o&&(a.tooken,a.save(),r.session.userId=a.id),s.redirect("/");case 6:case"end":return e.stop()}})})),module.exports=router;