"use strict";var _require=require("express"),Router=_require.Router,asyncHandler=require("express-async-handler"),router=new Router,User=require("../services/users");router.get("/",function(e,r){r.render("login")}),router.post("/",asyncHandler(function(r,s){var n,t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(User.findUserByEmail(r.body.email));case 2:if(n=e.sent,t=User.verifyPassword(r.body.password,n.password),n&&t){e.next=6;break}return e.abrupt("return",s.render("login"));case 6:r.session.userId=n.id,s.redirect("/");case 8:case"end":return e.stop()}})})),module.exports=router;